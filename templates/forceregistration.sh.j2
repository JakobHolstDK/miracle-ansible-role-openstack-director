#!/usr/bin/env bash

subscription-manager register --org={{ org }} --activation={{ activation_key }}

subscription-manager attach --pool={{ pool_id }}
subscription-manager release --set={{ rhel_version }}

subscription-manager repos --disable=*
subscription-manager repos \
--enable=rhel-{{ rhel }}-for-x86_64-baseos-eus-rpms \
--enable=rhel-{{ rhel }}-for-x86_64-appstream-eus-rpms \
--enable=rhel-{{ rhel }}-for-x86_64-highavailability-eus-rpms \
--enable=openstack-{{ openstack_release }}-for-rhel-8-x86_64-rpms \
--enable=rhel-{{ rhel }}-for-x86_64-baseos-rpms \
--enable=rhel-{{ rhel }}-for-x86_64-appstream-rpms \
--enable=fast-datapath-for-rhel-{{ rhel }}-x86_64-rpms

dnf update -y

exit 0





